# Shopping List Web App

做软件的人：“工作体验好，好事才能来。”

本代码库包含我的知乎“体验更好地做软件”专栏中的系列文章“K8s部署前后端分离的web应用避坑系列指南”的相关代码。

从2023年8月到10月，我花了3个月自学docker和k8s。踩了一路坑，到10月22日终于把一个带有vue.js 3前端、spring boot后端以及postgres数据库的shopping list web app，部署到azure k8s service云上，并能正常运行。

之所以说踩了一路坑，是因为网上分享的k8s部署web app的样例，都是部署一个web服务。即使讲ingress nginx controller的样例会涉及两个微服务，但在这种根据path设定将请求分配给两个hello world的web微服务场景，两个微服务之间，是没有前后端之间的依赖关系的。另外前后端之间的CORS跨源资源共享该如何解决，也找不到我这种前后端分离的web app场景下的直接资料，只能自己摸索。

在爬出坑后，很愿意写一系列避坑指南文章分享给大家。虽然不知小伙伴们是否愿意读，但我很想把这一系列文章，写成世界上通过实例讲docker和k8s入门的最好的文章，而且每年至少更新一次。要想找到这一系列文章的最新版本，可以在知乎搜“体验更好地做软件”专栏。

系列文章的目标读者，是对docker或k8s不太熟悉的做软件的人，不仅包括常写代码的程序员，也包括不常写代码的测试工程师和运维工程师。

K8s和Docker能解决做软件的人的什么痛点？这也是我为啥要花这么多时间写这一系列文章的原因。因为k8s和Docker可以让咱们做软件的人，能体验更好地做软件。“工作体验好，好事才能来。”想想咱们做软件的人常说的下面几句话。

“在我这运行得好好的，怎么你那儿不行？”docker image能将代码的所有依赖库都打包到一起，并能让代码在容器中独立运行。这样就能实现你在测试环境中所测试的image，就是你在生产环境所部署的，从而能在很大程度上解决因为依赖库在不同环境下的差异，而导致这里能运行，那里不能运行的问题。

“这是谁动了配置又不告诉大家？”Docker和k8s都强调基础设施即代码，即配置不是靠做软件的人拍脑袋临时手工敲的，而是靠写成与代码同等地位的配置文件，保存到版本库中，并让机器执行。这样能让配置的执行有据可查。同时也便于让机器读取，自动执行，而无须手工一遍一遍敲同样的命令。

“测试环境太少得排队使用。”有了docker compose，做软件的人可以利用其占用存储空间小，运行速度快的特点，在本地电脑以docker image的方式，最大限度模拟生产环境的方式，测试要发布的软件，而无须排队等公司共享的测试环境。这样能更快地发现bug。同样，在内部使用了k8s集群的企业，也能利用云的多租户特点，快速为需要测试环境的做软件的人，分配测试环境，从而解决测试环境少的问题。

可见，Docker和k8s能让咱们做软件的人的工作体验更好，好事更能来。

“为何选用Shopping List Web app作为样例项目？”这个样例源自我在自学vue.js时所学的待办列表todo list app样例。我把todo list改造为shopping list。两者的功能简单，都是为用户提供一个购物/待办列表，然后有一个web界面可以增删改查。这容易理解。此外，这个样例能代表前后端分离的web app典型架构。另外，这个样例能表现最小化的云原生微服务之间的依赖关系，便于学习如何使用混沌工程故障注入实验的工具。

“我对java和vue.js不熟，能读懂这一系列文章吗？”能。因为文章的代码命名写得足够表意，一看就懂。另外，这一系列文章不涉及前后端具体的编程，而重点关注如何把开发好的代码用docker打成image，并部署到docker compose和k8s上。这些都与前后端所使用的编程语言关系不大，所以文章内容适用于所有前后端分离的web app的技术栈。

“我不会编程，能读懂这一系列文章吗？”能。因为文章不涉及前后端功能的代码编写，而主要涉及配置文件和命令行工具的使用，适合程序员、测试工程师和运维工程师阅读。

“我是做测试或运维的，还需要安装文章的描述，在本地开发环境里跑通吗？”需要。因为当你需要在源代码里更改配置，并重新构建docker image时，你就需要知道如何操作。

这一系列文章会依次描述macOS、Windows10和Ubuntu这3种操作系统的操作步骤。

这一系列文章可以分为三篇，每一篇都包括Ubuntu、macOS和Windows 10三个操作系统下的操作步骤。这三篇的标题如下：

K8s部署前后端分离的web应用避坑系列指南之一：在本地开发环境、docker compose和k8s云集群里跑通购物清单应用（2023版）

K8s部署前后端分离的web应用避坑系列指南之二：解读购物清单应用Dockerfile和docker-compose.yml文件（2023版）

K8s部署前后端分离的web应用避坑系列指南之三：解读购物清单应用k8s的deployment、service和ingress配置文件（2023版）

这一系列指南相关的源代码，可以在这里下载：https://github.com/wubin28/shopping-list-web-app。

---
要想找到这一系列文章的最新版本，可以在知乎搜“体验更好地做软件”专栏。
如果你喜欢这一系列文章，欢迎点赞和收藏，并在留言区写下为何喜欢，以便我将来写更多你喜欢的文章。
如果你不喜欢，也欢迎你留言告诉我哪里可以再改进。
也可以 薇 x i n 我 wubinben28，备注“k8s”。
自我介绍一下。我笔名吾真本，本名伍斌。独立软件开发咨询师。“吾真本说混沌工程”知乎专栏主，专注软件系统稳定性设计。《混沌工程》合译者，《发布！》第2版译者。从业30年，做过开发、测试、项目管理、软件开发咨询。2014～2022年曾在Thoughtworks做过8年软件开发技术教练。帮助几十家企业的IT部门，落地持续集成和自动化测试等敏捷软件工程和DevOps工程实践。
